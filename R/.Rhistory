library(ggplot2)
library(quantmod)
start <- as.Date("2016-01-01")
end <- as.Date("2016-12-31")
getSymbols(Symbols = "AAPL;GOOG;MSFT;INTC;BOX",
src = "yahoo",
from = start,
to = end)
data <- data.frame("Apple" = as.numeric(AAPL$AAPL.Close),
"Google" = as.numeric(GOOG$GOOG.Close),
"Microsoft" = as.numeric(MSFT$MSFT.Close),
"Intel" = as.numeric(INTC$INTC.Close),
"Box" = as.numeric(BOX$BOX.Close))
log.data <- log(x = data)
ret.data <- data.frame(diff(x = as.matrix(log.data), lag = 1))
colnames(ret.data) <- c("Apple", "Google", "Microsoft", "Intel", "Box")
port.data <- data.frame(apply(X = ret.data,
MARGIN = 1,
FUN = function(x) weighted.mean(x = x, w = rep(x = 1 / ncol(ret.data), ncol(ret.data)))))
colnames(port.data) <- "Portfolio.ret"
ggplot(data = port.data,
aes(x = Portfolio.ret)) +
geom_density()
ggplot(data = port.data,
aes(x = Portfolio.ret)) +
geom_density(fill = "skyblue", alpha = 0.25)
tail.risks <- quantile(x = port.data$Portfolio.ret,
probs = c(0.01, 0.99))
est.sd <- as.matrix(apply(X = ret.data, MARGIN = 2, FUN = sd))
est.cor.matrix <- cor(x = ret.data)
est.cov.matrix <- est.cor.matrix * (est.sd %*% t(est.sd))
sqrt(t(as.matrix(rep(x = 1 / ncol(ret.data), ncol(ret.data)))) %*%
est.cov.matrix %*%
as.matrix(rep(x = 1 / ncol(ret.data), ncol(ret.data)))) *
qnorm(p = 0.01,
mean = 0,
sd = 1)
qnorm(p = 0.01,
mean = mean(port.data$Portfolio.ret),
sd = sqrt(t(as.matrix(rep(x = 1 / ncol(ret.data), ncol(ret.data)))) %*%
est.cov.matrix %*%
as.matrix(rep(x = 1 / ncol(ret.data), ncol(ret.data)))))
(sqrt(t(as.matrix(rep(x = 1 / ncol(ret.data), ncol(ret.data)))) %*%
est.cov.matrix %*%
as.matrix(rep(x = 1 / ncol(ret.data), ncol(ret.data)))) *
qnorm(p = 0.01,
mean = 0,
sd = 1)) +
mean(port.data$Portfolio.ret)
(sqrt(t(as.matrix(rep(x = 1 / ncol(ret.data), ncol(ret.data)))) %*%
est.cov.matrix %*%
as.matrix(rep(x = 1 / ncol(ret.data), ncol(ret.data)))) *
qnorm(p = 0.01,
mean = 0,
sd = 1)) +
mean(port.data$Portfolio.ret)
qnorm(p = 0.01,
mean = mean(port.data$Portfolio.ret),
sd = sqrt(t(as.matrix(rep(x = 1 / ncol(ret.data), ncol(ret.data)))) %*%
est.cov.matrix %*%
as.matrix(rep(x = 1 / ncol(ret.data), ncol(ret.data)))))
library(MASS)
mvrnorm(n = 1, mu = colMeans(x = port.data$Portfolio.ret), Sigma = est.cov.matrix)
mvrnorm(n = 1, mu = colMeans(x = port.data), Sigma = est.cov.matrix)
mvrnorm(n = 1, mu = colMeans(x = ret.data), Sigma = est.cov.matrix)
mvrnorm(n = 1, mu = colMeans(x = ret.data), Sigma = est.cov.matrix)
mvrnorm(n = 1, mu = colMeans(x = ret.data), Sigma = est.cov.matrix)
mvrnorm(n = 1, mu = colMeans(x = ret.data), Sigma = est.cov.matrix)
mvrnorm(n = 10, mu = colMeans(x = ret.data), Sigma = est.cov.matrix)
options(scipen = 999)
options(scipen = 999)
mvrnorm(n = 10, mu = colMeans(x = ret.data), Sigma = est.cov.matrix)
sim.ret.data <- mvrnorm(n = 100000,
mu = colMeans(x = ret.data),
Sigma = est.cov.matrix)
sim.port.data <- data.frame(apply(X = sim.ret.data,
MARGIN = 1,
FUN = function(x) weighted.mean(x = x, w = rep(x = 1 / ncol(sim.ret.data), ncol(sim.ret.data)))))
colnames(sim.port.data) <- "Portfolio.ret"
ggplot(data = sim.port.data,
aes(x = Portfolio.ret)) +
geom_density(fill = "skyblue", alpha = 0.25)
tail.risks <- quantile(x = sim.port.data$Portfolio.ret,
probs = c(0.01, 0.99))
tail.risk
tail.risks
sim.tail.risks <- quantile(x = sim.port.data$Portfolio.ret,
probs = c(0.01, 0.99))
sim.tail.risks
tail.risks <- quantile(x = port.data$Portfolio.ret,
probs = c(0.01, 0.99))
tail.risks
qnorm(p = 0.01,
mean = mean(port.data$Portfolio.ret),
sd = sqrt(t(as.matrix(rep(x = 1 / ncol(ret.data), ncol(ret.data)))) %*%
est.cov.matrix %*%
as.matrix(rep(x = 1 / ncol(ret.data), ncol(ret.data)))))
tail.risks <- quantile(x = sample(x = port.data$Portfolio.ret, size = 100000, replace = TRUE),
probs = c(0.01, 0.99))
tail.risks
est.ret.vector <- colMeans(x = ret.data)
est.ret.vector
est.ret.vector * 100
mean(est.ret.vector)
mean =
est.ret.vector <- colMeans(x = ret.data)
mean(port.data$Portfolio.ret)
start <- as.Date("2017-01-01")
end <- as.Date("2017-03-31")
start <- as.Date("2017-01-01")
end <- as.Date("2017-03-31")
getSymbols(Symbols = "AAPL;GOOG;MSFT;INTC;BOX",
src = "yahoo",
from = start,
to = end)
test.data <- data.frame("Apple" = as.numeric(AAPL$AAPL.Close),
"Google" = as.numeric(GOOG$GOOG.Close),
"Microsoft" = as.numeric(MSFT$MSFT.Close),
"Intel" = as.numeric(INTC$INTC.Close),
"Box" = as.numeric(BOX$BOX.Close))
log.test.data <- log(x = test.data)
test.ret.data <- data.frame(diff(x = as.matrix(log.test.data), lag = 1))
colnames(test.ret.data) <- c("Apple", "Google", "Microsoft", "Intel", "Box")
test.port.data <- data.frame(apply(X = test.ret.data,
MARGIN = 1,
FUN = function(x) weighted.mean(x = x, w = rep(x = 1 / ncol(test.ret.data), ncol(test.ret.data)))))
colnames(test.port.data) <- "Portfolio.ret"
ggplot(data = test.port.data,
aes(x = Portfolio.ret)) +
geom_density(fill = "skyblue", alpha = 0.25)
test.tail.risks <- quantile(x = sample(x = test.port.data$Portfolio.ret, size = 100000, replace = TRUE),
probs = c(0.01, 0.99))
test.tail.risks
tail.risks
start <- as.Date("2017-01-01")
end <- as.Date("2017-12-31")
getSymbols(Symbols = "AAPL;GOOG;MSFT;INTC;BOX",
src = "yahoo",
from = start,
to = end)
test.data <- data.frame("Apple" = as.numeric(AAPL$AAPL.Close),
"Google" = as.numeric(GOOG$GOOG.Close),
"Microsoft" = as.numeric(MSFT$MSFT.Close),
"Intel" = as.numeric(INTC$INTC.Close),
"Box" = as.numeric(BOX$BOX.Close))
log.test.data <- log(x = test.data)
test.ret.data <- data.frame(diff(x = as.matrix(log.test.data), lag = 1))
colnames(test.ret.data) <- c("Apple", "Google", "Microsoft", "Intel", "Box")
test.port.data <- data.frame(apply(X = test.ret.data,
MARGIN = 1,
FUN = function(x) weighted.mean(x = x, w = rep(x = 1 / ncol(test.ret.data), ncol(test.ret.data)))))
colnames(test.port.data) <- "Portfolio.ret"
ggplot(data = test.port.data,
aes(x = Portfolio.ret)) +
geom_density(fill = "skyblue", alpha = 0.25)
test.tail.risks <- quantile(x = sample(x = test.port.data$Portfolio.ret, size = 100000, replace = TRUE),
probs = c(0.01, 0.99))
tail.risks
test.tail.risks
