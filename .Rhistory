ncol = 2)))
} else {
return(mvrnorm(n = 1,
mu = c(-0.25, -0.05),
Sigma = matrix(data = c(5, 3, 3, 4),
nrow = 2,
ncol = 2)))
}
}
daily.ret.data <- data.frame(do.call(rbind, lapply(X = 1:1000, FUN = daily.ret)))
colnames(daily.ret.data) <- c("Asset.1", "Asset.2")
ggplot(data = daily.ret.data,
aes(x = Asset.1, y = Asset.2)) +
geom_density2d()
daily.ret <- function(i) {
dice <- runif(n = 1,
min = 0,
max = 1)
if (dice < 0.5) {
return(mvrnorm(n = 1,
mu = c(0.15, 0.05),
Sigma = matrix(data = c(0.5, 3, 3, 0.4),
nrow = 2,
ncol = 2)))
} else {
return(mvrnorm(n = 1,
mu = c(-0.25, -0.05),
Sigma = matrix(data = c(5, 0, 0, 4),
nrow = 2,
ncol = 2)))
}
}
daily.ret.data <- data.frame(do.call(rbind, lapply(X = 1:1000, FUN = daily.ret)))
colnames(daily.ret.data) <- c("Asset.1", "Asset.2")
ggplot(data = daily.ret.data,
aes(x = Asset.1, y = Asset.2)) +
geom_density2d()
daily.ret <- function(i) {
dice <- runif(n = 1,
min = 0,
max = 1)
if (dice < 0.5) {
return(mvrnorm(n = 1,
mu = c(0.15, 0.05),
Sigma = matrix(data = c(0.5, 0.3, 0.3, 0.4),
nrow = 2,
ncol = 2)))
} else {
return(mvrnorm(n = 1,
mu = c(-0.25, -0.05),
Sigma = matrix(data = c(5, 0, 0, 4),
nrow = 2,
ncol = 2)))
}
}
daily.ret.data <- data.frame(do.call(rbind, lapply(X = 1:1000, FUN = daily.ret)))
colnames(daily.ret.data) <- c("Asset.1", "Asset.2")
ggplot(data = daily.ret.data,
aes(x = Asset.1, y = Asset.2)) +
geom_density2d()
daily.port.data <- data.frame(apply(X = daily.ret.data,
MARGIN = 1,
FUN = function(x) weighted.mean(x = x, w = c(0.5, 0.5))))
colnames(daily.port.data) <- "Portfolio.ret"
ggplot(data = daily.port.data,
aes(x = Portfolio.ret)) +
geom_density()
daily.ret <- function(i) {
dice <- runif(n = 1,
min = 0,
max = 1)
if (dice < 0.5) {
return(mvrnorm(n = 1,
mu = c(0.15, 0.05),
Sigma = matrix(data = c(0.5, 0.3, 0.3, 0.4),
nrow = 2,
ncol = 2)))
} else {
return(mvrnorm(n = 1,
mu = c(-0.25, -0.05),
Sigma = matrix(data = c(50, 0, 0, 40),
nrow = 2,
ncol = 2)))
}
}
daily.ret.data <- data.frame(do.call(rbind, lapply(X = 1:1000, FUN = daily.ret)))
colnames(daily.ret.data) <- c("Asset.1", "Asset.2")
ggplot(data = daily.ret.data,
aes(x = Asset.1, y = Asset.2)) +
geom_density2d()
daily.port.data <- data.frame(apply(X = daily.ret.data,
MARGIN = 1,
FUN = function(x) weighted.mean(x = x, w = c(0.5, 0.5))))
colnames(daily.port.data) <- "Portfolio.ret"
ggplot(data = daily.port.data,
aes(x = Portfolio.ret)) +
geom_density()
daily.ret <- function(i) {
dice <- runif(n = 1,
min = 0,
max = 1)
if (dice < 0.5) {
return(mvrnorm(n = 1,
mu = c(0.15, 0.05),
Sigma = matrix(data = c(0.5, 0.3, 0.3, 0.4),
nrow = 2,
ncol = 2)))
} else {
return(mvrnorm(n = 1,
mu = c(-0.25, -0.05),
Sigma = matrix(data = c(50, 10, 10, 40),
nrow = 2,
ncol = 2)))
}
}
daily.ret.data <- data.frame(do.call(rbind, lapply(X = 1:1000, FUN = daily.ret)))
colnames(daily.ret.data) <- c("Asset.1", "Asset.2")
ggplot(data = daily.ret.data,
aes(x = Asset.1, y = Asset.2)) +
geom_density2d()
daily.port.data <- data.frame(apply(X = daily.ret.data,
MARGIN = 1,
FUN = function(x) weighted.mean(x = x, w = c(0.5, 0.5))))
colnames(daily.port.data) <- "Portfolio.ret"
ggplot(data = daily.port.data,
aes(x = Portfolio.ret)) +
geom_density()
start <- as.Date("2010-01-01")
end <- as.Date("2016-10-01")
start <- as.Date("2010-01-01")
end <- as.Date("2016-10-01")
getSymbols(Symbols = "AAPL;GOOG;MSFT", src = "yahoo", from = start, to = end)
head(AAPL)
head(GOOG)
head(MSFT)
AAPL$AAPL.Open
data.frame("Apple" = as.numeric(AAPL$AAPL.Close),
"Google" = as.numeric(GOOG$GOOG.Close),
"Microsoft" = as.numeric(MSFT$MSFT.Close))
data <- data.frame("Apple" = as.numeric(log(AAPL$AAPL.Close)),
"Google" = as.numeric(log(GOOG$GOOG.Close)),
"Microsoft" = as.numeric(log(MSFT$MSFT.Close)))
data
diff(Data)
diff(data)
diff(as.matrix(data))
options(scipen = 999)
diff(as.matrix(data))
head(data)
data <- data.frame("Apple" = as.numeric(AAPL$AAPL.Close),
"Google" = as.numeric(GOOG$GOOG.Close),
"Microsoft" = as.numeric(MSFT$MSFT.Close))
log(data)
data
head(data)
log(30.62/30.57)
log(30.62) - log(30.57)
log(30.62 / 30.57)
30.57 * exp(0.001634254)
data <- data.frame("Apple" = as.numeric(AAPL$AAPL.Close),
"Google" = as.numeric(GOOG$GOOG.Close),
"Microsoft" = as.numeric(MSFT$MSFT.Close))
log.data <- log(x = data)
ret.data <- diff(x = log.data, lag = 1)
data <- data.frame("Apple" = as.numeric(AAPL$AAPL.Close),
"Google" = as.numeric(GOOG$GOOG.Close),
"Microsoft" = as.numeric(MSFT$MSFT.Close))
log.data <- log(x = data)
ret.data <- diff(x = as.matrix(log.data), lag = 1)
ret.data
library(quantmod)
start <- as.Date("2010-01-01")
end <- as.Date("2016-10-01")
getSymbols(Symbols = "AAPL;GOOG;MSFT", src = "yahoo", from = start, to = end)
data <- data.frame("Apple" = as.numeric(AAPL$AAPL.Close),
"Google" = as.numeric(GOOG$GOOG.Close),
"Microsoft" = as.numeric(MSFT$MSFT.Close))
log.data <- log(x = data)
ret.data <- data.frame(diff(x = as.matrix(log.data), lag = 1))
colnames(ret.data) <- c("Apple", "Google", "Microsoft")
ret.data
rep(x = 1 / 3, 3)
port.data <- data.frame(apply(X = ret.data,
MARGIN = 1,
FUN = function(x) weighted.mean(x = x, w = rep(x = 1 / 3, 3))))
port.data
colnames(daily.port.data) <- "Portfolio.ret"
colnames(port.data) <- "Portfolio.ret"
ggplot(data = port.data,
aes(x = Portfolio.ret)) +
geom_density()
start <- as.Date("2014-01-01")
end <- as.Date("2016-10-01")
getSymbols(Symbols = "AAPL;GOOG;MSFT",
src = "yahoo",
from = start,
to = end)
data <- data.frame("Apple" = as.numeric(AAPL$AAPL.Close),
"Google" = as.numeric(GOOG$GOOG.Close),
"Microsoft" = as.numeric(MSFT$MSFT.Close))
log.data <- log(x = data)
ret.data <- data.frame(diff(x = as.matrix(log.data), lag = 1))
colnames(ret.data) <- c("Apple", "Google", "Microsoft")
port.data <- data.frame(apply(X = ret.data,
MARGIN = 1,
FUN = function(x) weighted.mean(x = x, w = rep(x = 1 / 3, 3))))
colnames(port.data) <- "Portfolio.ret"
ggplot(data = port.data,
aes(x = Portfolio.ret)) +
geom_density()
start <- as.Date("2014-01-01")
end <- as.Date("2016-10-01")
getSymbols(Symbols = "AAPL;GOOG;MSFT;INTC;BABA",
src = "yahoo",
from = start,
to = end)
data <- data.frame("Apple" = as.numeric(AAPL$AAPL.Close),
"Google" = as.numeric(GOOG$GOOG.Close),
"Microsoft" = as.numeric(MSFT$MSFT.Close),
"Intel" = as.numeric(INTC$INTC.Close),
"Alibaba" = as.numeric(BABA$BABA.Close))
log.data <- log(x = data)
ret.data <- data.frame(diff(x = as.matrix(log.data), lag = 1))
colnames(ret.data) <- c("Apple", "Google", "Microsoft", "Intel", "Alibaba")
start <- as.Date("2010-01-01")
end <- as.Date("2016-10-01")
getSymbols(Symbols = "AAPL;GOOG;MSFT;INTC;BABA",
src = "yahoo",
from = start,
to = end)
data <- data.frame("Apple" = as.numeric(AAPL$AAPL.Close),
"Google" = as.numeric(GOOG$GOOG.Close),
"Microsoft" = as.numeric(MSFT$MSFT.Close),
"Intel" = as.numeric(INTC$INTC.Close),
"Alibaba" = as.numeric(BABA$BABA.Close))
log.data <- log(x = data)
ret.data <- data.frame(diff(x = as.matrix(log.data), lag = 1))
colnames(ret.data) <- c("Apple", "Google", "Microsoft", "Intel", "Alibaba")
library(quantmod)
start <- as.Date("2010-01-01")
end <- as.Date("2016-10-01")
getSymbols(Symbols = "AAPL;GOOG;MSFT;INTC",
src = "yahoo",
from = start,
to = end)
data <- data.frame("Apple" = as.numeric(AAPL$AAPL.Close),
"Google" = as.numeric(GOOG$GOOG.Close),
"Microsoft" = as.numeric(MSFT$MSFT.Close),
"Intel" = as.numeric(INTC$INTC.Close))
log.data <- log(x = data)
ret.data <- data.frame(diff(x = as.matrix(log.data), lag = 1))
colnames(ret.data) <- c("Apple", "Google", "Microsoft", "Intel")
port.data <- data.frame(apply(X = ret.data,
MARGIN = 1,
FUN = function(x) weighted.mean(x = x, w = rep(x = 1 / 3, 3))))
colnames(port.data) <- "Portfolio.ret"
ggplot(data = port.data,
aes(x = Portfolio.ret)) +
geom_density()
port.data <- data.frame(apply(X = ret.data,
MARGIN = 1,
FUN = function(x) weighted.mean(x = x, w = rep(x = 1 / 4, 4))))
colnames(port.data) <- "Portfolio.ret"
ggplot(data = port.data,
aes(x = Portfolio.ret)) +
geom_density()
start <- as.Date("2010-01-01")
end <- as.Date("2016-10-01")
getSymbols(Symbols = "AAPL;GOOG;MSFT;INTC;DB",
src = "yahoo",
from = start,
to = end)
data <- data.frame("Apple" = as.numeric(AAPL$AAPL.Close),
"Google" = as.numeric(GOOG$GOOG.Close),
"Microsoft" = as.numeric(MSFT$MSFT.Close),
"Intel" = as.numeric(INTC$INTC.Close),
"Deutsche" = as.numeric(DB$DB.Close))
log.data <- log(x = data)
ret.data <- data.frame(diff(x = as.matrix(log.data), lag = 1))
colnames(ret.data) <- c("Apple", "Google", "Microsoft", "Intel", "Deutsche")
port.data <- data.frame(apply(X = ret.data,
MARGIN = 1,
FUN = function(x) weighted.mean(x = x, w = rep(x = 1 / 5, 5))))
colnames(port.data) <- "Portfolio.ret"
ggplot(data = port.data,
aes(x = Portfolio.ret)) +
geom_density()
port.data <- data.frame(apply(X = ret.data,
MARGIN = 1,
FUN = function(x) weighted.mean(x = x, w = c(0.05, 0.05, 0.05, 0.05, 0.8))))
colnames(port.data) <- "Portfolio.ret"
ggplot(data = port.data,
aes(x = Portfolio.ret)) +
geom_density()
port.data <- data.frame(apply(X = ret.data,
MARGIN = 1,
FUN = function(x) weighted.mean(x = x, w = rep(x = 1 / 5, 5))))
colnames(port.data) <- "Portfolio.ret"
ggplot(data = port.data,
aes(x = Portfolio.ret)) +
geom_density()
getSymbols(Symbols = "AAPL;GOOG;MSFT;INTC;BOX",
src = "yahoo",
from = start,
to = end)
data <- data.frame("Apple" = as.numeric(AAPL$AAPL.Close),
"Google" = as.numeric(GOOG$GOOG.Close),
"Microsoft" = as.numeric(MSFT$MSFT.Close),
"Intel" = as.numeric(INTC$INTC.Close),
"Deutsche" = as.numeric(BOX$BOX.Close))
start <- as.Date("2014-01-01")
end <- as.Date("2016-10-01")
getSymbols(Symbols = "AAPL;GOOG;MSFT;INTC;BOX",
src = "yahoo",
from = start,
to = end)
data <- data.frame("Apple" = as.numeric(AAPL$AAPL.Close),
"Google" = as.numeric(GOOG$GOOG.Close),
"Microsoft" = as.numeric(MSFT$MSFT.Close),
"Intel" = as.numeric(INTC$INTC.Close),
"Deutsche" = as.numeric(BOX$BOX.Close))
start <- as.Date("2015-01-01")
end <- as.Date("2016-10-01")
getSymbols(Symbols = "AAPL;GOOG;MSFT;INTC;BOX",
src = "yahoo",
from = start,
to = end)
data <- data.frame("Apple" = as.numeric(AAPL$AAPL.Close),
"Google" = as.numeric(GOOG$GOOG.Close),
"Microsoft" = as.numeric(MSFT$MSFT.Close),
"Intel" = as.numeric(INTC$INTC.Close),
"Deutsche" = as.numeric(BOX$BOX.Close))
start <- as.Date("2015-05-01")
end <- as.Date("2016-10-01")
getSymbols(Symbols = "AAPL;GOOG;MSFT;INTC;BOX",
src = "yahoo",
from = start,
to = end)
data <- data.frame("Apple" = as.numeric(AAPL$AAPL.Close),
"Google" = as.numeric(GOOG$GOOG.Close),
"Microsoft" = as.numeric(MSFT$MSFT.Close),
"Intel" = as.numeric(INTC$INTC.Close),
"Deutsche" = as.numeric(BOX$BOX.Close))
log.data <- log(x = data)
ret.data <- data.frame(diff(x = as.matrix(log.data), lag = 1))
colnames(ret.data) <- c("Apple", "Google", "Microsoft", "Intel", "Deutsche")
port.data <- data.frame(apply(X = ret.data,
MARGIN = 1,
FUN = function(x) weighted.mean(x = x, w = rep(x = 1 / 5, 5))))
colnames(port.data) <- "Portfolio.ret"
ggplot(data = port.data,
aes(x = Portfolio.ret)) +
geom_density()
port.data <- data.frame(apply(X = ret.data,
MARGIN = 1,
FUN = function(x) weighted.mean(x = x, w = c(0.05, 0.05, 0.05, 0.05, 0.8))))
colnames(port.data) <- "Portfolio.ret"
ggplot(data = port.data,
aes(x = Portfolio.ret)) +
geom_density()
port.data <- data.frame(apply(X = ret.data,
MARGIN = 1,
FUN = function(x) weighted.mean(x = x, w = c(0.025, 0.025, 0.2, 0.25, 0.5))))
colnames(port.data) <- "Portfolio.ret"
ggplot(data = port.data,
aes(x = Portfolio.ret)) +
geom_density()
port.data <- data.frame(apply(X = ret.data,
MARGIN = 1,
FUN = function(x) weighted.mean(x = x, w = c(0.025, 0.025, 0.2, 0.25, 0.95))))
colnames(port.data) <- "Portfolio.ret"
ggplot(data = port.data,
aes(x = Portfolio.ret)) +
geom_density()
port.data <- data.frame(apply(X = ret.data,
MARGIN = 1,
FUN = function(x) weighted.mean(x = x, w = c(0.025, 0.025, 0.2, 0.25, 10.95))))
colnames(port.data) <- "Portfolio.ret"
ggplot(data = port.data,
aes(x = Portfolio.ret)) +
geom_density()
tail.risks <- quantile(x = port.data,
probs = c(0.01, 0.99))
port.data
tail.risks <- quantile(x = port.data,
probs = c(0.01, 0.99))
tail.risks <- quantile(x = port.data$Portfolio.ret,
probs = c(0.01, 0.99))
tail.risks
est.sd <- as.matrix(apply(X = ret.data, MARGIN = 2, FUN = sd))
est.sd
est.cor.matrix <- cor(x = ret.data)
est.cor.matrix
start <- as.Date("2015-05-01")
end <- as.Date("2016-10-01")
getSymbols(Symbols = "AAPL;GOOG;MSFT;INTC;BOX",
src = "yahoo",
from = start,
to = end)
data <- data.frame("Apple" = as.numeric(AAPL$AAPL.Close),
"Google" = as.numeric(GOOG$GOOG.Close),
"Microsoft" = as.numeric(MSFT$MSFT.Close),
"Intel" = as.numeric(INTC$INTC.Close),
"Box" = as.numeric(BOX$BOX.Close))
log.data <- log(x = data)
ret.data <- data.frame(diff(x = as.matrix(log.data), lag = 1))
colnames(ret.data) <- c("Apple", "Google", "Microsoft", "Intel", "Box")
port.data <- data.frame(apply(X = ret.data,
MARGIN = 1,
FUN = function(x) weighted.mean(x = x, w = c(0.025, 0.025, 0.2, 0.25, 10.95))))
colnames(port.data) <- "Portfolio.ret"
ggplot(data = port.data,
aes(x = Portfolio.ret)) +
geom_density()
tail.risks <- quantile(x = port.data$Portfolio.ret,
probs = c(0.01, 0.99))
tail.risks
est.sd <- as.matrix(apply(X = ret.data, MARGIN = 2, FUN = sd))
est.cor.matrix <- cor(x = ret.data)
est.cor.matrix
est.cov.matrix <- est.cor.matrix * (est.sd %*% t(est.sd))
est.cov.matrix
print(tail.risks)
print(est.cov.matrix)
print(tail.risks)
print(est.cor.matrix)
print(est.cov.matrix)
port.data <- data.frame(apply(X = ret.data,
MARGIN = 1,
FUN = function(x) weighted.mean(x = x, w = rep(x = 1 / ncol(ret.data), ncol(ret.data)))))
getSymbols(Symbols = "AAPL;GOOG;MSFT;INTC;BOX",
src = "yahoo",
from = start,
to = end)
data <- data.frame("Apple" = as.numeric(AAPL$AAPL.Close),
"Google" = as.numeric(GOOG$GOOG.Close),
"Microsoft" = as.numeric(MSFT$MSFT.Close),
"Intel" = as.numeric(INTC$INTC.Close),
"Box" = as.numeric(BOX$BOX.Close))
log.data <- log(x = data)
ret.data <- data.frame(diff(x = as.matrix(log.data), lag = 1))
colnames(ret.data) <- c("Apple", "Google", "Microsoft", "Intel", "Box")
port.data <- data.frame(apply(X = ret.data,
MARGIN = 1,
FUN = function(x) weighted.mean(x = x, w = rep(x = 1 / ncol(ret.data), ncol(ret.data)))))
colnames(port.data) <- "Portfolio.ret"
ggplot(data = port.data,
aes(x = Portfolio.ret)) +
geom_density()
tail.risks <- quantile(x = port.data$Portfolio.ret,
probs = c(0.01, 0.99))
est.sd <- as.matrix(apply(X = ret.data, MARGIN = 2, FUN = sd))
est.cor.matrix <- cor(x = ret.data)
est.cov.matrix <- est.cor.matrix * (est.sd %*% t(est.sd))
print(tail.risks)
print(est.cor.matrix)
print(est.cov.matrix)
install.packages("qmao")
rep(x = 1 / ncol(ret.data), ncol(ret.data)
)
rep(x = 1 / ncol(ret.data), ncol(ret.data))
t(as.matrix(rep(x = 1 / ncol(ret.data), ncol(ret.data)))) %*% rep(x = 1 / ncol(ret.data), ncol(ret.data) %*% as.matrix(rep(x = 1 / ncol(ret.data), ncol(ret.data)))
)
t(as.matrix(rep(x = 1 / ncol(ret.data), ncol(ret.data)))) %*% est.cov.matrix %*% as.matrix(rep(x = 1 / ncol(ret.data), ncol(ret.data)))
t(as.matrix(rep(x = 1 / ncol(ret.data), ncol(ret.data)))) %*% est.cov.matrix %*% as.matrix(rep(x = 1 / ncol(ret.data), ncol(ret.data))) * 2
sqrt(t(as.matrix(rep(x = 1 / ncol(ret.data), ncol(ret.data)))) %*% est.cov.matrix %*% as.matrix(rep(x = 1 / ncol(ret.data), ncol(ret.data)))) * 2
sqrt(t(as.matrix(rep(x = 1 / ncol(ret.data), ncol(ret.data)))) %*% est.cov.matrix %*% as.matrix(rep(x = 1 / ncol(ret.data), ncol(ret.data)))) * -2
tail.risks
sqrt(t(as.matrix(rep(x = 1 / ncol(ret.data), ncol(ret.data)))) %*% est.cov.matrix %*% as.matrix(rep(x = 1 / ncol(ret.data), ncol(ret.data)))) * -2
qnorm(p = 0.01, mean = 0, sd = 1)
sqrt(t(as.matrix(rep(x = 1 / ncol(ret.data), ncol(ret.data)))) %*% est.cov.matrix %*% as.matrix(rep(x = 1 / ncol(ret.data), ncol(ret.data)))) * qnorm(p = 0.01, mean = 0, sd = 1)
tail.risks
qnorm(p = 0.01, mean = 0, sd = sqrt(t(as.matrix(rep(x = 1 / ncol(ret.data), ncol(ret.data)))) %*% est.cov.matrix %*% as.matrix(rep(x = 1 / ncol(ret.data), ncol(ret.data)))))
port.data
mean()
mean(port.data)
mean(port.data$Portfolio.ret)
qnorm(p = 0.01, mean = mean(port.data$Portfolio.ret), sd = sqrt(t(as.matrix(rep(x = 1 / ncol(ret.data), ncol(ret.data)))) %*% est.cov.matrix %*% as.matrix(rep(x = 1 / ncol(ret.data), ncol(ret.data)))))
tail.risks
start <- as.Date("2016-01-01")
end <- as.Date("2016-12-31")
getSymbols(Symbols = "AAPL;GOOG;MSFT;INTC;BOX",
src = "yahoo",
from = start,
to = end)
data <- data.frame("Apple" = as.numeric(AAPL$AAPL.Close),
"Google" = as.numeric(GOOG$GOOG.Close),
"Microsoft" = as.numeric(MSFT$MSFT.Close),
"Intel" = as.numeric(INTC$INTC.Close),
"Box" = as.numeric(BOX$BOX.Close))
log.data <- log(x = data)
ret.data <- data.frame(diff(x = as.matrix(log.data), lag = 1))
colnames(ret.data) <- c("Apple", "Google", "Microsoft", "Intel", "Box")
port.data <- data.frame(apply(X = ret.data,
MARGIN = 1,
FUN = function(x) weighted.mean(x = x, w = rep(x = 1 / ncol(ret.data), ncol(ret.data)))))
colnames(port.data) <- "Portfolio.ret"
ggplot(data = port.data,
aes(x = Portfolio.ret)) +
geom_density()
tail.risks <- quantile(x = port.data$Portfolio.ret,
probs = c(0.01, 0.99))
est.sd <- as.matrix(apply(X = ret.data, MARGIN = 2, FUN = sd))
est.cor.matrix <- cor(x = ret.data)
est.cov.matrix <- est.cor.matrix * (est.sd %*% t(est.sd))
print(tail.risks)
print(est.cor.matrix)
print(est.cov.matrix)
qnorm(p = 0.01, mean = mean(port.data$Portfolio.ret), sd = sqrt(t(as.matrix(rep(x = 1 / ncol(ret.data), ncol(ret.data)))) %*% est.cov.matrix %*% as.matrix(rep(x = 1 / ncol(ret.data), ncol(ret.data)))))
sqrt(t(as.matrix(rep(x = 1 / ncol(ret.data), ncol(ret.data)))) %*% est.cov.matrix %*% as.matrix(rep(x = 1 / ncol(ret.data), ncol(ret.data)))) * qnorm(p = 0.01, mean = 0, sd = 1)
qnorm(p = 0.005, mean = mean(port.data$Portfolio.ret), sd = sqrt(t(as.matrix(rep(x = 1 / ncol(ret.data), ncol(ret.data)))) %*% est.cov.matrix %*% as.matrix(rep(x = 1 / ncol(ret.data), ncol(ret.data)))))
tail.risks
